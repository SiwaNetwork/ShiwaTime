# ShiwaTime

ShiwaTime – легковесный демон на Go для высокоточной синхронизации времени и публикации метрик в Elasticsearch. 

## Возможности

* Поддержка первичных и вторичных источников времени (NTP сейчас, PTP и другие – в планах).
* Настройка через YAML–конфигурацию, максимально совместимую с `timebeat.yml`.
* Два режима работы:
  * monitor – выполняет только измерения и экспорт метрик;
  * adjust  – измеряет и автоматически корректирует системное время (step / slew).
* Отправка метрик задержки/смещения в Elasticsearch для последующего анализа.
* HTTP-/CLI-API (планируется).

## Быстрый старт

```bash
# Сборка
make build        # или go build ./cmd/shiwa

# Запуск
sudo ./shiwa -config timebeat.yml
```

> Обязательно запускайте ShiwaTime c полномочиями `CAP_SYS_TIME`, иначе коррекция
> системного времени будет недоступна.

## Структура проекта

```
cmd/shiwa          точка входа, инициализация
internal/
  config/          парсер YAML-конфигурации
  source/          абстракции и реализации time-source’ов
    ntp/           NTP-клиент
    ptp/           (todo)
  clock/           step/slew коррекция системных часов
  metrics/         экспорт метрик в Elasticsearch
```

## Дальнейшие планы

1. Реализовать PTP-клиент с аппаратной отметкой времени.
2. Поддержка PPS, PHC и специализированных timecard-устройств.
3. Расширенная логика steering (`sigma`, `rho` и др.).
4. Веб-интерфейс и REST API для мониторинга.
5. Расширенная совместимость с полной схемой `timebeat.yml`.

---

Проект находится в активной разработке. Добро пожаловать к обсуждению и
pull-request’ам!